{% extends 'base.html' %}
{% load template_filters %}
	{% block content %}
		<!-- SECTION -->
		<div class="section">
			<!-- container -->
			<div class="container">
				<!-- row -->
				<div class="row">

					<div class="col-md-7">
						<!-- Shiping Details -->

						<!-- Order notes -->
						<div class="order-notes">
							<label>Manzilingizni kiriting</label>
							<textarea class="input" placeholder="Manzil"></textarea>
						</div>
						<!-- /Order notes -->
					</div>

					<!-- Order Details -->
					<div class="col-md-5 order-details">
						<div class="section-title text-center">
							<h3 class="title">Buyurtmalaringiz</h3>
						</div>
						<div class="order-summary">
							<div class="order-col">
								<div><strong>Mahsulot</strong></div>
								<div><strong>Jami</strong></div>
								<div><strong>O'chirish</strong></div>
							</div>
							{% for i in order_list %}
								<div class="order-products">
									<div class="order-col">
										<div><a href="{% url 'product_detail' i.product.id %}">{{ i.product.name }} </a><span style="color: red;">{{ i.quantity }}ta</span></div>
										<div>
											<!-- Add a unique ID to identify the span element -->
											<span id="priceCalculs{{ forloop.counter }}"></span>
										</div>
										<form method="post" action="{% url 'delete_order' i.id %}">
											{% csrf_token %}
											<input type="submit" class="btn btn-danger" value="O'chirish">
										</form>
									</div>
									<hr>
								</div>
							{% endfor %}
							<div class="order-col">
								<div><strong>Jami narxi</strong></div>
								<div><strong class="order-total">{{ price|sum_converter }} so'm</strong></div>
							</div>
						</div>
						<a href="#" class="primary-btn order-submit">Buyurtma qilish</a>
					</div>
					<!-- /Order Details -->
				</div>
				<!-- /row -->
			</div>
			<!-- /container -->
		</div>
		<!-- /SECTION -->
<script>
	function sumConverter(val) {
    val = val.toString().split('').reverse().join('');
    let count = 0;
    let result = '';
    for (let i = 0; i < val.length; i++) {
        if (count % 3 === 0 && count !== 0) {
            result = result + ' ' + val[i];
        } else {
            result = result + val[i];
        }
        count++;
    }
    return result.split('').reverse().join('');
	}

	{% for i in order_list %}
        var price = {{ i.product.price }} * {{ i.quantity }};
        document.getElementById('priceCalculs{{ forloop.counter }}').textContent = sumConverter(price) + " so'm";

    {% endfor %}
</script>
{% endblock content %}